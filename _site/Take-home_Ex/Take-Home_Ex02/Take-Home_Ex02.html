<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Law Man Long">
<meta name="dcterms.date" content="2023-01-29">

<title>ISSS608-VAA - Take Home Exercise 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS608-VAA</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_ex/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_ex/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-Home_Ex01/Take-home_Ex01.html">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-Home_Ex02/Take-home_Ex02.html">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">1. Overview</a></li>
  <li><a href="#critics" id="toc-critics" class="nav-link" data-scroll-target="#critics">2. Critics</a>
  <ul class="collapse">
  <li><a href="#aesthetics" id="toc-aesthetics" class="nav-link" data-scroll-target="#aesthetics">2.1 Aesthetics</a></li>
  <li><a href="#clarity" id="toc-clarity" class="nav-link" data-scroll-target="#clarity">2.2 Clarity</a></li>
  </ul></li>
  <li><a href="#proposed-sketch" id="toc-proposed-sketch" class="nav-link" data-scroll-target="#proposed-sketch">3. Proposed Sketch</a>
  <ul class="collapse">
  <li><a href="#pareto-chart" id="toc-pareto-chart" class="nav-link" data-scroll-target="#pareto-chart">3.1 Pareto Chart</a></li>
  <li><a href="#age-sex-population-pyramid" id="toc-age-sex-population-pyramid" class="nav-link" data-scroll-target="#age-sex-population-pyramid">3.2 Age-Sex Population Pyramid</a></li>
  </ul></li>
  <li><a href="#remake" id="toc-remake" class="nav-link" data-scroll-target="#remake">4. Remake</a>
  <ul class="collapse">
  <li><a href="#getting-ready" id="toc-getting-ready" class="nav-link" data-scroll-target="#getting-ready">4.1 Getting ready</a></li>
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data">4.2 Import Data</a></li>
  <li><a href="#pareto-chart-1" id="toc-pareto-chart-1" class="nav-link" data-scroll-target="#pareto-chart-1">4.3 Pareto Chart</a>
  <ul class="collapse">
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">4.3.1 Data Wrangling</a></li>
  <li><a href="#compute-cumulative-percentage-by-planning-area" id="toc-compute-cumulative-percentage-by-planning-area" class="nav-link" data-scroll-target="#compute-cumulative-percentage-by-planning-area">Compute cumulative percentage by planning area</a></li>
  <li><a href="#plot-pareto-chart" id="toc-plot-pareto-chart" class="nav-link" data-scroll-target="#plot-pareto-chart">4.3.2 Plot Pareto Chart</a></li>
  </ul></li>
  <li><a href="#age-sex-population-pyramid-1" id="toc-age-sex-population-pyramid-1" class="nav-link" data-scroll-target="#age-sex-population-pyramid-1">4.4 Age-Sex Population Pyramid</a>
  <ul class="collapse">
  <li><a href="#data-wrangling-1" id="toc-data-wrangling-1" class="nav-link" data-scroll-target="#data-wrangling-1">4.4.1 Data Wrangling</a></li>
  <li><a href="#compute-the-population-percentage-by-age-and-sex" id="toc-compute-the-population-percentage-by-age-and-sex" class="nav-link" data-scroll-target="#compute-the-population-percentage-by-age-and-sex">Compute the population percentage by age and sex</a></li>
  <li><a href="#plot-population-pyramid-in-trellis-view" id="toc-plot-population-pyramid-in-trellis-view" class="nav-link" data-scroll-target="#plot-population-pyramid-in-trellis-view">4.4.2 Plot Population Pyramid in Trellis View</a></li>
  </ul></li>
  <li><a href="#data-insights" id="toc-data-insights" class="nav-link" data-scroll-target="#data-insights">4.5 Data Insights</a></li>
  </ul></li>
  <li><a href="#learning-point" id="toc-learning-point" class="nav-link" data-scroll-target="#learning-point">5. Learning Point</a>
  <ul class="collapse">
  <li><a href="#aesthetics-1" id="toc-aesthetics-1" class="nav-link" data-scroll-target="#aesthetics-1">Aesthetics</a></li>
  <li><a href="#clarity-1" id="toc-clarity-1" class="nav-link" data-scroll-target="#clarity-1">Clarity</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take Home Exercise 2</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Law Man Long </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 29, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="overview" class="level1">
<h1>1. Overview</h1>
<p>In this take-home exercise, I will critic one of the Take-home Exercise 1 prepared by classmate in terms of clarity and aesthetics, and propose a remake using data visualisation design principles and best practices in lesson 1 &amp; 2.</p>
<p>The data set used for this exercise is downloaded from <a href="https://www.singstat.gov.sg/find-data/search-by-theme/population/geographic-distribution/latest-data">Popoulation Trend Data, DoSS</a>, and I will remake the original design by using ggplot2, ggplot2 extensions and tidyverse packages in Rstudio.</p>
</section>
<section id="critics" class="level1">
<h1>2. Critics</h1>
<p>The <a href="https://public.tableau.com/app/profile/aishwarya.maloo7070/viz/Take-Home_Ex01/Dashboard1?publish=yes">original dashboard</a> show the demographic structure of Singapore for top 9 most populated planning area. Age-sex pyramid is used to display gender and age group pattern in different planning areas. Nine selected planning areas is displayed on a single view by using trellis display.</p>
<p><img src="images/image-139655184.png" class="img-fluid"></p>
<section id="aesthetics" class="level3">
<h3 class="anchored" data-anchor-id="aesthetics">2.1 Aesthetics</h3>
<ul>
<li><p>The overall theme of the graph is clean and easy to understand, The author made a good effort to fit the 9 charts in one single view. There is no overwhelming details and the graphs are easy to read</p></li>
<li><p>Sub-chart title format and position can be standardized for more professional look</p></li>
<li><p>The author can use distinct color to represent male and female population instead to show the age pattern for different gender for more meaningful insight</p></li>
<li><p>Vertical grid line can be added for easier reading of population %</p></li>
<li><p>Y axis label format and position can be capitalized and improved for easier reading</p></li>
</ul>
</section>
<section id="clarity" class="level3">
<h3 class="anchored" data-anchor-id="clarity">2.2 Clarity</h3>
<ul>
<li><p>The graph is generally clear in terms of title, x-axis label and overall layout. Data source is also included in caption.</p></li>
<li><p>Y-axis label age classification is unclear. Some patterns might be missing when the age data is grouped</p></li>
<li><p>% of total population would be better to illustrate gender pattern across age group. Can label only the max or min to emphasize on the most important information</p></li>
<li><p>Missing information on total population to illustrate the 9 selected planning areas are the most populated in Singapore</p></li>
<li><p>More insights can be derived if each planning area age-sex pattern is compared to overall singapore sex-age pattern</p></li>
</ul>
</section>
</section>
<section id="proposed-sketch" class="level1">
<h1>3. Proposed Sketch</h1>
<p>Below sketches are created to illustrate the ideal data visualisation for ggplot2.</p>
<section id="pareto-chart" class="level2">
<h2 class="anchored" data-anchor-id="pareto-chart">3.1 Pareto Chart</h2>
<p><img src="images/IMG-0719-reduced.jpg" class="img-fluid"></p>
<p>Pareto chart is used to illustrate the overall population of Singapore residents by planning area, and how much percentage that the top 9 planning areas represent. It gives a good idea on the significance of top populated areas within Singapore.</p>
</section>
<section id="age-sex-population-pyramid" class="level2">
<h2 class="anchored" data-anchor-id="age-sex-population-pyramid">3.2 Age-Sex Population Pyramid</h2>
<p><img src="images/IMG-0720-reduced.jpg" class="img-fluid"></p>
<p>We keep the age-sex populated pyramid, but will improve in terms of the aesthetics and clarity. The key focus will be put on identifying the difference of planning area against the overall Singapore population.</p>
</section>
</section>
<section id="remake" class="level1">
<h1>4. Remake</h1>
<section id="getting-ready" class="level2">
<h2 class="anchored" data-anchor-id="getting-ready">4.1 Getting ready</h2>
<p>Installing Packages</p>
<p>I use <strong>tidyverse</strong> package which includes <strong>ggplot2, dplyr, tidyr and readr</strong> for this makeover exercise. The code chunk below uses p_load() of pacman package to check if tidyverse packages is installed in the computer. If yes, then they will be launched into R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-data" class="level2">
<h2 class="anchored" data-anchor-id="import-data">4.2 Import Data</h2>
<p>Data set named “respopagesextod2022” is used for the exercise below. Data is import using readr package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>pop_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/respopagesextod2022.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pop_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  PA         SZ                     AG     Sex   TOD                   Pop  Time
  &lt;chr&gt;      &lt;chr&gt;                  &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt;
1 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males HDB 1- and 2-Room …     0  2022
2 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males HDB 3-Room Flats       10  2022
3 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males HDB 4-Room Flats       10  2022
4 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males HDB 5-Room and Exe…    30  2022
5 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males HUDC Flats (exclud…     0  2022
6 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males Condominiums and O…    50  2022</code></pre>
</div>
</div>
</section>
<section id="pareto-chart-1" class="level2">
<h2 class="anchored" data-anchor-id="pareto-chart-1">4.3 Pareto Chart</h2>
<section id="data-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="data-wrangling">4.3.1 Data Wrangling</h3>
</section>
<section id="compute-cumulative-percentage-by-planning-area" class="level3">
<h3 class="anchored" data-anchor-id="compute-cumulative-percentage-by-planning-area">Compute cumulative percentage by planning area</h3>
<p>Below code chunk is used to calculate total population of Singapore</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>grandpop <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">sum</span>(pop_data<span class="sc">$</span>Pop))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Below code chunk is used to calculate the cumulative population percentage of each planning area. It filters all the 0 in population, group the data by planning area and summarize the population, and then create a new column for total population, which later sort into descending order and calculate the cumulative percentage of total population.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>total_pop <span class="ot">&lt;-</span> pop_data <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Pop <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(PA) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">totalpop =</span> <span class="fu">sum</span>(Pop)) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">grandpop=</span>grandpop) <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(totalpop)) <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percpop =</span> totalpop<span class="sc">/</span>grandpop) <span class="sc">%&gt;%</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cumpop =</span> <span class="fu">cumsum</span>(percpop)) <span class="sc">%&gt;%</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cumabspop =</span> <span class="fu">cumsum</span>(totalpop))</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(total_pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  PA          totalpop grandpop percpop cumpop cumabspop
  &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;
1 Bedok         278640  4081540  0.0683 0.0683    278640
2 Tampines      265690  4081540  0.0651 0.133     544330
3 Jurong West   258540  4081540  0.0633 0.197     802870
4 Sengkang      253120  4081540  0.0620 0.259    1055990
5 Woodlands     252510  4081540  0.0619 0.321    1308500
6 Hougang       227540  4081540  0.0557 0.376    1536040</code></pre>
</div>
</div>
</section>
<section id="plot-pareto-chart" class="level3">
<h3 class="anchored" data-anchor-id="plot-pareto-chart">4.3.2 Plot Pareto Chart</h3>
<p>Pareto chart shows the population of planning area in descending order and cumulative percentage. This is to illustrate which are the top populated areas in Singapore and identify the most significant area for later analysis. Pareto chart was plotted using ggplot2 as follows:</p>
<ul>
<li><p>geom_col() is used to create the bars and color and width is adjust for neater look</p></li>
<li><p>geom_point() &amp; geom_line is used to plot the line for cumulative percentage</p></li>
<li><p>scale_y_continuous is used for to create secondary axis for the cumulative percentage of population</p></li>
<li><p>theme() is adjusted to standardize axis text and title for neater look</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> total_pop, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(PA, <span class="sc">-</span>totalpop))) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">y=</span>totalpop), <span class="at">fill =</span> <span class="st">'lightblue'</span>, <span class="at">width=</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>cumpop<span class="sc">*</span><span class="dv">278640</span>), <span class="at">color =</span> <span class="st">'grey20'</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>cumpop<span class="sc">*</span><span class="dv">278640</span>, <span class="at">group =</span> <span class="dv">1</span>), <span class="at">colour =</span> <span class="st">'grey20'</span>, <span class="at">size =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Planning Areas"</span>, <span class="at">title =</span> <span class="st">"Pareto chart of population by planning area"</span>) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">'Population'</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">300000</span>, <span class="dv">50000</span>), <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">300000</span>, <span class="dv">50000</span>),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">*</span><span class="dv">1</span><span class="sc">/</span><span class="dv">278640</span>, <span class="at">name =</span> <span class="st">'Cumulative Percentage of Population'</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>), <span class="at">labels =</span> scales<span class="sc">::</span>percent) </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>), <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="age-sex-population-pyramid-1" class="level2">
<h2 class="anchored" data-anchor-id="age-sex-population-pyramid-1">4.4 Age-Sex Population Pyramid</h2>
<p>A sex-age population pyramid shows the distribution of population by age groups and sex, which can be used to visualize the overall structure of a particular population. The shape of the pyramid can be used to indicate the reproductive capabilities and likelihood of continuation of a species. Our target is to show the population structure of top 9 populated planning area in one single view.</p>
<section id="data-wrangling-1" class="level3">
<h3 class="anchored" data-anchor-id="data-wrangling-1">4.4.1 Data Wrangling</h3>
</section>
<section id="compute-the-population-percentage-by-age-and-sex" class="level3">
<h3 class="anchored" data-anchor-id="compute-the-population-percentage-by-age-and-sex">Compute the population percentage by age and sex</h3>
<p>We are going to compute the percentage of particular planning area population by gender and age. Below are the codes to transform the data.</p>
<ol type="1">
<li>Summarize population by planning area, sex and age group and rearrange the order of age group</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"0_to_4"</span>, <span class="st">"5_to_9"</span>, <span class="st">"10_to_14"</span>, <span class="st">"15_to_19"</span>, <span class="st">"20_to_24"</span>, <span class="st">"25_to_29"</span>, <span class="st">"30_to_34"</span>, <span class="st">"35_to_39"</span>, <span class="st">"40_to_44"</span>, <span class="st">"45_to_49"</span>, <span class="st">"50_to_54"</span>, <span class="st">"55_to_59"</span>, <span class="st">"60_to_64"</span>, <span class="st">"65_to_69"</span>, <span class="st">"70_to_74"</span>, <span class="st">"75_to_79"</span>, <span class="st">"80_to_84"</span>, <span class="st">"85_to_89"</span>, <span class="st">"90_and_over"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>pyramid <span class="ot">&lt;-</span> pop_data <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Pop <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AG =</span>  <span class="fu">factor</span>(AG, <span class="at">levels =</span> order)) <span class="sc">%&gt;%</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(AG) <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(PA, Sex, AG) <span class="sc">%&gt;%</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pymd_pop =</span> <span class="fu">sum</span>(Pop)) <span class="sc">%&gt;%</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">grandpop=</span>grandpop)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pyramid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
# Groups:   PA, Sex [1]
  PA         Sex     AG       pymd_pop grandpop
  &lt;chr&gt;      &lt;chr&gt;   &lt;fct&gt;       &lt;dbl&gt;    &lt;dbl&gt;
1 Ang Mo Kio Females 0_to_4       2480  4081540
2 Ang Mo Kio Females 5_to_9       3120  4081540
3 Ang Mo Kio Females 10_to_14     3320  4081540
4 Ang Mo Kio Females 15_to_19     3620  4081540
5 Ang Mo Kio Females 20_to_24     4030  4081540
6 Ang Mo Kio Females 25_to_29     5020  4081540</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Calculate the total population by planning area</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>total_pop_PA <span class="ot">&lt;-</span> total_pop <span class="sc">|&gt;</span> <span class="fu">select</span>(PA, totalpop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>Join the two data frame to form a data set with population by planning area and population by planning area, age group and sex. Calculate the percentage with the two columns.</li>
<li>Create a data frame for the overall population</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>joined_tab <span class="ot">&lt;-</span> <span class="fu">left_join</span>(pyramid, total_pop_PA,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'PA'</span> <span class="ot">=</span> <span class="st">'PA'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pymd_pop_perc =</span> pymd_pop<span class="sc">/</span>totalpop)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>topdata <span class="ot">&lt;-</span> <span class="fu">top_n</span>(total_pop_PA, <span class="at">n=</span><span class="dv">9</span>, totalpop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="5" type="1">
<li>Prepare data for the overall population pyramid by grouping data by sex and age, and summarize the population</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>overall_pyramid <span class="ot">&lt;-</span> pop_data <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Pop <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AG =</span>  <span class="fu">factor</span>(AG, <span class="at">levels =</span> order)) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(AG) <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Sex, AG) <span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pymd_pop =</span> <span class="fu">sum</span>(Pop)) <span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">totalpop=</span>grandpop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plot-population-pyramid-in-trellis-view" class="level3">
<h3 class="anchored" data-anchor-id="plot-population-pyramid-in-trellis-view">4.4.2 Plot Population Pyramid in Trellis View</h3>
<p>The population pyramid was plot using ggplot as follows:</p>
<ul>
<li><p>geom_col() was used to create the bar chart, and ifelse() is used to convert male population percentage to the left of the graph and female to the right.</p></li>
<li><p>Formula of pymd_pop/totalpop is used to calculate the population percentage for each age group and sex.</p></li>
<li><p>The color and format of overall population pyramid is adjusted to lighter grey for easier reading</p></li>
<li><p>labs() was used to assign main title and axis titles.</p></li>
<li><p>scale_x_continuous() is used to tidy up the the x axis label for clarity</p></li>
<li><p>theme() is used to adjust font size and position for neater look</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> joined_tab <span class="sc">%&gt;%</span> <span class="fu">filter</span>(PA <span class="sc">%in%</span> topdata<span class="sc">$</span>PA)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">ifelse</span>(Sex <span class="sc">==</span> <span class="st">"Males"</span>, <span class="at">yes =</span> <span class="sc">-</span>(pymd_pop<span class="sc">/</span>totalpop), <span class="at">no =</span> pymd_pop<span class="sc">/</span>totalpop), <span class="at">y =</span> AG, <span class="at">fill =</span> Sex)) <span class="sc">+</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">geom_col</span>(<span class="at">data =</span> overall_pyramid, <span class="at">fill =</span> <span class="st">'grey'</span>) <span class="sc">+</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">geom_col</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">facet_wrap</span>(<span class="sc">~</span> PA) <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">x =</span> <span class="st">"Population percentage"</span>, <span class="at">y =</span> <span class="st">"Age"</span>, <span class="at">title=</span><span class="st">'Singapore Age-Sex Population Pyramid by Planning Area in Jun 2022'</span>) <span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.06</span>, <span class="fl">0.06</span>, <span class="fl">0.02</span>), <span class="at">labels =</span> <span class="fu">abs</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.06</span>, <span class="fl">0.06</span>, <span class="fl">0.02</span>))) <span class="sc">+</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">22</span>),</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</section>
</section>
<section id="data-insights" class="level2">
<h2 class="anchored" data-anchor-id="data-insights">4.5 Data Insights</h2>
<ul>
<li><p>With the new Pareto chart, we are able to identify the top 9 populated areas in Singapore, which make up on more than 50% of total Singapore population</p></li>
<li><p>With the remake Age-Sex pyramid, we can observe more patterns from different planning area:</p>
<ul>
<li><p>Punggol and Tampines have very different age-sex pattern with the overall Singapore population and the rest of the planning areas</p></li>
<li><p>Jurong West has a similar age-sex pattern with overall population</p></li>
<li><p>Sengkang, Punggol and Tampines have relatively higher younger population</p></li>
<li><p>Hougang, Jurong West and Bedok has more 60 years or above population</p></li>
</ul></li>
</ul>
</section>
</section>
<section id="learning-point" class="level1">
<h1>5. Learning Point</h1>
<section id="aesthetics-1" class="level2">
<h2 class="anchored" data-anchor-id="aesthetics-1">Aesthetics</h2>
<ul>
<li><p>When there is multiple chart of elements on the same graph, it is important to adjust the color of the chart to shows what is the primary information (planning area population) and secondary information (overall population)</p></li>
<li><p>Color should be used to contrast important information and should be used carefully</p></li>
<li><p>Simple background is preferred when there are multiple graphs in the same view</p></li>
</ul>
</section>
<section id="clarity-1" class="level2">
<h2 class="anchored" data-anchor-id="clarity-1">Clarity</h2>
<ul>
<li><p>Some insights might be lost if we group data unnecessarily, for example the age group pattern will be lost if we group the different age groups together</p></li>
<li><p>Not all data labels should be shown, sometimes simple is beauty</p></li>
<li><p>Data comparison is a good way to draw additional insights in our graphs, for example we compare overall population with planning area population for more insights</p></li>
<li><p>Data visualisation is about trial and error. Sometimes you have to go through many iteration in order to have the best outcome. It is important to be patient during the process.</p></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>